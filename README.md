# アパレル店舗週次レポート作成システム

AI を活用したアパレル店舗の週次レポート自動生成システムです。

## 機能概要

- 📈 **週次レポート作成**: 店舗ごとの日次データからAIが週次レポートを生成
- � **レポートダウンロード**: 過去のレポートのダウンロード機能（Excel/CSV）
- 🤖 **AI学習機能**: ユーザーの修正から学習し、精度を向上
- 🏪 **マルチ店舗対応**: RAY、RSJ、ROS、RNGの4店舗に対応
- 📱 **マルチデバイス対応**: PC、iPhone、iPad、タブレットから同時編集可能
- 🔄 **リアルタイム同期**: 複数デバイス間でのリアルタイムデータ同期

## 🌟 マルチデバイス同時編集機能

### 📱 対応デバイス
- **デスクトップPC** (Windows/Mac/Linux)
- **iPhone/iPad** (Safari推奨)
- **Androidタブレット/スマートフォン**
- **その他モバイルデバイス**

### 🔄 同時編集の仕組み
- **店舗別分担**: 各店舗を異なるデバイスで同時に編集
- **リアルタイム同期**: 入力データが即座に他のデバイスと同期
- **編集状況表示**: 現在編集中のデバイス数をリアルタイム表示
- **自動保存**: すべての入力が自動的に保存・同期

### 💡 使用例
```
RAY店舗: デスクトップPC（店長）
RSJ店舗: iPad（副店長）
ROS店舗: iPhone（スタッフA）
RNG店舗: ノートPC（スタッフB）
```

### 🌐 アクセス方法
**同一ネットワーク内の複数デバイスからアクセス:**
- デスクトップ: `http://localhost:8501`
- 他のデバイス: `http://[PC_IP_ADDRESS]:8501`
  例: `http://192.168.1.157:8501`

**外部ネットワークからのアクセス:**
- クラウドデプロイ時: `https://your-domain.com`
- VPN接続経由でのリモートアクセス

## システム要件

- Python 3.8以上
- Streamlit
- OpenAI API キー（GPT-4o-mini使用）

## セットアップ手順

### 1. リポジトリのクローン
```bash
git clone https://github.com/4392td/report_app.git
cd report_app
```

### 2. 仮想環境の作成と有効化
```bash
python -m venv env
source env/bin/activate  # macOS/Linux
# または
env\Scripts\activate     # Windows
```

### 3. 依存関係のインストール
```bash
pip install -r requirements.txt
```

### 4. 環境変数の設定（重要）
`.env`ファイルを作成し、OpenAI APIキーを設定してください：

```bash
# .envファイルの作成
echo "OPENAI_API_KEY=your_openai_api_key_here" > .env
```

**⚠️ セキュリティ注意事項:**
- `.env`ファイルは`.gitignore`で除外されており、Gitにコミットされません
- 本番環境では、環境変数またはシークレット管理サービスを使用してください
- APIキーを絶対にコードに直接埋め込まないでください

### 5. アプリケーションの起動
```bash
streamlit run report_app.py
```

## 使用方法

### 1. 週次レポート作成
1. サイドバーから「週次レポート作成」を選択
2. 対象週の月曜日を選択
3. 各店舗の日次データを入力
4. 「AIレポートを生成」ボタンをクリック
5. 必要に応じてレポートを修正し、学習機能に反映

### 2. レポートダウンロード
1. サイドバーから「レポートダウンロード」を選択
2. 店舗を選択してレポート一覧を表示
3. 対象レポートを選択してExcel/CSVでダウンロード

### 3. 設定確認
1. サイドバーから「設定」を選択
2. APIキーの設定状況を確認

## 管理者向け情報

### API キーの管理
- 本システムではセキュリティ上の理由により、UIからのAPIキー入力は無効化されています
- APIキーは`.env`ファイルまたは環境変数で管理してください
- 複数ユーザー環境では、サーバーレベルでの環境変数設定を推奨します

### データベース
- SQLiteデータベース（`apparel_reports.db`）を使用
- 自動的に必要なテーブルが作成されます
- バックアップは定期的に取得することを推奨します

## トラブルシューティング

### APIキーエラー
- 「OpenAI APIキーが設定されていません」エラーが表示される場合：
  1. `.env`ファイルが存在するか確認
  2. APIキーが正しく設定されているか確認
  3. アプリケーションを再起動

### データベースエラー
- データベース関連のエラーが発生した場合、`apparel_reports.db`ファイルを削除してアプリを再起動すると、新しいデータベースが作成されます

## 開発・貢献

このプロジェクトへの貢献を歓迎します。プルリクエストやイシューの作成をお願いします。

## ライセンス

このプロジェクトは MIT License の下で公開されています。

## サポート

問題が発生した場合は、GitHubのIssuesページでお知らせください。